

## 什么是乐观锁
## 乐观锁的实现原理
### 1、CAS如何实现原子操作
### 2、处理器如何实现原子操作
## 优化CAS乐观锁
## 总结

synchronized和lock实现的同步锁机制，这两种不同锁都属于悲观锁，是保护线程安全的最直观的方式。

我们知道悲观锁在高并发的场景下，激烈的锁竞争会造成线程阻塞，大量阻塞线程会导致系统大量的上下文切换，增加系统的性能开销。那有没有可能一种非阻塞型的锁机制来保证线程安全呢？

## 什么是乐观锁
乐观锁：顾名思义，就是说在操作共享资源时，它总是抱着乐观的态度进行，他认为自己可以成功地完成操作。但实际上，当多个线程同时操作一个共享资源时，只有一个线程会成功，那么失败的线程呢？它们不会像悲观锁一样在操作系统中挂起，而仅仅是返回，并且系统允许失败的线程重试，也允许自动放弃退出操作。

乐观锁相比悲观锁来说，不会带来死锁、饥饿等活性故障问题，线程间的相互影响也远比悲观锁要效。

更为重要的是 **乐观锁没有因竞争造成的系统开销，所以在性能上也是更胜一筹**


## 乐观锁的实现原理
CAS 是实现乐观锁的核心算法，它包含了 3 个参数：V（需要更新的变量）、E（预期值）和 N（最新值）。

只有当需要更新的变量等于预期值时，需要更新的变量才会被设置为最新值，如果更新值和预期值不同，则说明已经有其它线程更新了需要更新的变量，此时当前线程不做操作，返回 V 的真实值。

### 1、CAS如何实现原子操作？
在JDK中的Concurrent包下，atomic路径下的类都是基于CAS实现的。AtimicInteger就是基于CAS实现的一个线程安全的整型类

### 2、处理器如何实现原子操作








